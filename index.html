<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>tt.fsp — Tomatonator Thrower</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="icon" href="icon.png">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  user-select:none;
  -webkit-user-select:none;
  touch-action:none;
}

body{
  background:#7F7F7F;
  font-family:Arial, Helvetica, sans-serif;
  overflow:hidden;
}

/* TOP BAR */
.topbar{
  height:60px;
  background:#8F8F8F;
  display:flex;
  align-items:center;
  gap:32px;
  padding:0 20px;
}

.topbar img{
  height:34px;
}

.nav span{
  cursor:pointer;
  font-size:15px;
  padding:10px 14px;
}

/* CONTENT */
.content{
  position:relative;
  width:100vw;
  height:calc(100vh - 60px);
}

/* MODES */
.mode{
  position:absolute;
  inset:0;
  display:none;
}

.mode.active{
  display:block;
}

/* VISUAL */
#visual{
  position:relative;
}

#template{
  position:absolute;
  inset:0;
  background-image:url("template.png");
  background-repeat:no-repeat;
  background-position:center;
  background-size:340px auto;
  pointer-events:none;
}

/* TOMATO */
.tomato{
  position:absolute;
  width:420px; /* BEM GRANDE */
  pointer-events:none;
}

/* PANELS */
.panel{
  padding:20px;
  font-size:15px;
}
</style>
</head>

<body>

<div class="topbar">
  <img src="icon.png">
  <div class="nav">
    <span data-mode="visual">Visual</span>
    <span data-mode="editor">Editor</span>
    <span data-mode="about">About</span>
  </div>
</div>

<div class="content">
  <div id="visual" class="mode active">
    <div id="template"></div>
  </div>

  <div id="editor" class="mode panel">
    <b>Editor</b>
  </div>

  <div id="about" class="mode panel">
    <b>tt.fsp — Fire Source Project</b><br><br>

    <b>what's is this for?</b><br>
    it's an web html where it makes the "Tomato Throw meme" easier to recreate ig.<br><br>

    <b>why did u make this html?</b><br>
    just for fun.<br><br>

    <b>what's fsp?</b><br>
    fsp stands for Fire-Source-Project.
  </div>
</div>

<audio id="bgm" src="bgm.ogg" loop></audio>

<script>
const modes = document.querySelectorAll(".mode");
const visual = document.getElementById("visual");
const bgm = document.getElementById("bgm");

/* MODE SWITCH */
function setMode(name){
  modes.forEach(m => m.classList.remove("active"));
  document.getElementById(name).classList.add("active");

  document.querySelectorAll(".tomato").forEach(t => t.remove());

  if(name === "editor" || name === "about"){
    bgm.volume = 1;
    bgm.play().catch(()=>{});
  }else{
    fadeOutBGM();
  }
}

document.querySelectorAll(".nav span").forEach(btn=>{
  btn.onclick = ()=> setMode(btn.dataset.mode);
});

/* BGM FADE */
function fadeOutBGM(){
  let v = bgm.volume;
  const i = setInterval(()=>{
    v -= 0.05;
    if(v <= 0){
      clearInterval(i);
      bgm.pause();
      bgm.currentTime = 0;
      bgm.volume = 1;
    }else{
      bgm.volume = v;
    }
  }, 30);
}

/* TOMATO */
function spawnTomato(x,y){
  const rect = visual.getBoundingClientRect();

  const img = document.createElement("img");
  img.src = "tomato.gif";
  img.className = "tomato";
  img.style.left = (x - rect.left - 210) + "px";
  img.style.top  = (y - rect.top  - 210) + "px";

  visual.appendChild(img);

  const s = new Audio("splash.ogg");
  s.play().catch(()=>{});

  /* freeze real */
  setTimeout(()=>{
    img.src = "tomato_last.png";
  }, 1200);
}

/* INPUT */
let down = false;

visual.addEventListener("pointerdown", e=>{
  down = true;
  spawnTomato(e.clientX, e.clientY);
});

visual.addEventListener("pointermove", e=>{
  if(down){
    spawnTomato(e.clientX, e.clientY);
  }
});

window.addEventListener("pointerup", ()=> down = false);
</script>

</body>
</html>
